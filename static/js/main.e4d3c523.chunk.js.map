{"version":3,"sources":["version.js","Generator.js","App.js","index.js"],"names":["VERSION","date2int","date","dayjs","format","FormGroup","css","Input","DateInput","PreviewContainer","PreviewText","DownloadButton","AttendanceDay","props","className","index","type","value","entry","itemId","onChange","e","changeItem","target","amount","changeAmount","download","filename","text","element","document","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","App","now","useState","startDate","setStartDate","endDate","setEndDate","items","setItems","changeItemProperty","useCallback","key","slice","useEffect","Storage","localStorage","getItem","saveVersion","JSON","parse","Array","fill","setItem","stringify","luaFile","useMemo","start","end","map","item","join","generate_lua","yamlFile","generate_yaml","downloadLua","ReactGA","event","category","action","downloadYaml","htmlFor","cx","id","min","onClick","initialize","pageview","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.e4d3c523.chunk.js","sourcesContent":["const VERSION = \"1.1.0\"\n\nexport default VERSION\n","import dayjs from 'dayjs'\nimport VERSION from './version'\n\nfunction date2int(date) {\n    return dayjs(date).format('YYYYMMDD')\n}\n\nexport function generate_lua(items, start, end) {\n    return `-- Generated with Secret's Attendance Generator version ${VERSION}\nConfig = { StartDate = ${date2int(start)}, EndDate = ${date2int(end)} }\nReward = {\n    ${\n        items.map((item, index) => `{ ${index+1}, ${item.itemId}, ${item.amount} }` ).join(',\\n    ')\n    }\n}\n\nmain = function()\n    result, msg = InsertCheckAttendanceConfig(Config.EvendOnOff, Config.StartDate, Config.EndDate)\n    if not result == true then\n        return false, msg\n    end\n    for k, rewardtbl in pairs(Reward) do\n        result, msg = InsertCheckAttendanceReward(rewardtbl[1], rewardtbl[2], rewardtbl[3])\n        if not result == true then\n            return false, msg\n        end\n    end\n    return true, \"success\"\nend\n`\n}\n\nexport function generate_yaml(items, start, end) {\n    return `# Generated with Secret's Attendance Generator version ${VERSION}\nHeader:\n  Type: ATTENDANCE_DB\n  Version: 1\n  \nBody:\n  - Start: ${date2int(start)}\n    End: ${date2int(end)}\n    Rewards:\n${\n    items.map((item, index) => \n`      - Day: ${index+1}\n        ItemId: ${item.itemId}\n        Amount: ${item.amount}\n`).join('')\n}\n`\n}\n","import React, { useState, useEffect, useCallback, useMemo } from 'react'\nimport dayjs from 'dayjs'\nimport { css, cx } from 'emotion'\nimport { generate_lua, generate_yaml } from './Generator'\nimport VERSION from './version'\nimport ReactGA from 'react-ga'\n\nconst DATE_FORMAT = 'YYYY-MM-DD'\nconst SAVE_VERSION = '1'\n\nconst FormGroup = css`\npadding-top: 2px;\npadding-bottom: 2px;\nmargin: 5px;\n`;\n\nconst Input = css`\npadding: 5px;\nborder: 1px solid rgba(0,0,0,0.2);\nmargin: 0 5px 0 5px;\nwidth: 65px;\n`\n\nconst DateInput = css`\nwidth: 127px;\n`\n\nconst PreviewContainer = css`\nwidth: 45%;\nheight: 250px;\n`\n\nconst PreviewText = css`\nwidth: 100%;\nheight: 100%;\n`\n\nconst DownloadButton = css`\nwidth: 100%;\nheight: 30px;\nbackground: #00d1b2;\nborder-radius: 4px;\nbox-shadow: none;\nborder: 1px solid transparent;\n:hover {\n  background: #00c4a7;\n}\n:active {\n  background: #00b89c;\n}\n`\n\nconst AttendanceDay = (props) => (\n  <div className={css`\n    margin: 5px;\n    box-sizing: border-box;\n    flex: 1 0 45%;\n  `}>\n    <label>Day {props.index+1} ID</label>\n    <input className={Input} type=\"number\" value={props.entry.itemId} onChange={(e) => props.changeItem(e.target.value, props.index)} />\n    <label>Amount</label>\n    <input className={Input} type=\"number\" value={props.entry.amount} onChange={(e) => props.changeAmount(e.target.value, props.index)} />\n  </div>\n)\n\nconst App = () => {\n    const now = dayjs()\n    const [startDate, setStartDate] = useState(now.format(DATE_FORMAT))\n    const [endDate, setEndDate] = useState(now.format(DATE_FORMAT))\n    const [items, setItems] = useState([]);\n    const changeItemProperty = useCallback((key, value, index) => {\n      setItems([\n        ...items.slice(0, index),\n        { ...items[index], [key]: value },\n        ...items.slice(index+1)\n      ])\n    }, [items])\n\n    useEffect(() => {\n      if(typeof(Storage) === 'undefined') {\n        return\n      }\n    \n      let items = localStorage.getItem('savedItems')\n      const saveVersion = localStorage.getItem('saveVersion')\n      try {\n        if (saveVersion !== null && saveVersion === SAVE_VERSION) {\n          items = JSON.parse(items)\n        }\n      } catch {\n        items = Array(20).fill({ itemId: 501, amount: 1})\n      }\n      if (items !== null) {\n        setItems(items)\n      } else {\n        setItems(Array(20).fill({ itemId: 501, amount: 1 }))\n      }\n    }, [])\n\n    useEffect(() => {\n      localStorage.setItem('saveVersion', SAVE_VERSION)\n      localStorage.setItem('savedItems', JSON.stringify(items))\n    }, [items])\n\n    const luaFile = useMemo(\n      () => generate_lua(items, startDate, endDate),\n      [items, startDate, endDate]\n    )\n\n    const yamlFile = useMemo(\n      () => generate_yaml(items, startDate, endDate),\n      [items, startDate, endDate]\n    )\n\n    const downloadLua = useCallback(() => { \n      ReactGA.event({\n        category: 'User',\n        action: 'Downloaded Lua file'\n      })\n      download('CheckAttendance.lub', luaFile)\n    }, [luaFile])\n  \n    const downloadYaml = useCallback(() => {\n      ReactGA.event({\n        category: 'User',\n        action: 'Downloaded YAML file'\n      })\n      download('attendance.yml', yamlFile)\n    }, [yamlFile])\n\n    return (\n      <div className={css`text-align: center;`}>\n        <header className={css`\n          background-color: #222;\n          height: 100px;\n          padding: 20px;\n          color: white;\n        `}>\n          <h1 className={css`font-size: 1.5em; margin-bottom: 5px;`}>Attendance Generator v.{VERSION}</h1>\n          <h5 className={css`margin-top: 0; margin-bottom: 5px;`}>for rAthena and RO Client</h5>\n          <h6 className={css`margin-top: 10px;`}>&copy; 2018-2020 Jittapan P. All rights reserved.</h6>\n        </header>\n        <div className={css`margin-top: 10px;`}>\n          <div className={css`\n            display: flex;\n            justify-content: center;\n          `}>\n            <div className={FormGroup}>\n              <label htmlFor=\"start\">Start date:</label>\n              <input className={cx(Input, DateInput)} type=\"date\" id=\"start\" onChange={e => setStartDate(e.target.value)} value={startDate} />\n            </div>\n            <div className={FormGroup}>\n              <label htmlFor=\"end\">End date:</label>\n              <input className={cx(Input, DateInput)} type=\"date\" id=\"end\" onChange={e => setEndDate(e.target.value)} min={startDate} value={endDate} />\n            </div>\n          </div>\n          <div className={css`\n            margin: 0 auto;\n            display: flex;\n            width: 100%;\n            flex-direction: column;\n            flex-wrap: wrap;\n            justify-content: space-around;\n            align-content: center;\n            @media screen and (min-width: 640px) {\n              width: 640px;\n              flex-direction: row;\n            }\n          `}>\n            {\n              items.map((entry, index) =>\n                <AttendanceDay\n                  changeItem={(itemId, index) => changeItemProperty('itemId', itemId, index)}\n                  changeAmount={(amount, index) => changeItemProperty('amount', amount, index)}\n                  index={index}\n                  entry={entry}\n                />\n              )\n            }\n          </div>\n        </div>\n        <div className={css`\n          margin: 10px auto 0 auto;\n          display: flex;\n          justify-content: space-around;\n        `}>\n          <div className={PreviewContainer}>\n            <h2>CheckAttendance.lub</h2>\n            <textarea className={PreviewText} value={luaFile} />\n            <button className={DownloadButton} onClick={downloadLua}>Download</button>\n          </div>\n          <div className={PreviewContainer}>\n            <h2>attendance.yml</h2>\n            <textarea className={PreviewText} value={yamlFile} />\n            <button className={DownloadButton} onClick={downloadYaml}>Download</button>\n          </div>\n        </div>\n      </div>\n    )\n}\n\nfunction download(filename, text) {\n  var element = document.createElement('a');\n  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\n  element.setAttribute('download', filename);\n\n  element.style.display = 'none';\n  document.body.appendChild(element);\n\n  element.click();\n\n  document.body.removeChild(element);\n}\n\nexport default App;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport ReactGA from 'react-ga'\n\nReactGA.initialize('UA-145842310-1')\nReactGA.pageview('/')\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}