{"version":3,"sources":["version.js","Generator.js","App.js","index.js"],"names":["VERSION","date2int","date","dayjs","format","FormGroup","css","Input","DateInput","PreviewContainer","PreviewText","DownloadButton","AttendanceDay","props","className","index","type","value","entry","itemId","onChange","e","changeItem","target","amount","changeAmount","download","filename","text","element","document","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","App","now","useState","startDate","setStartDate","endDate","setEndDate","items","setItems","changeItemProperty","useCallback","key","slice","useEffect","Storage","localStorage","getItem","saveVersion","JSON","parse","Array","fill","setItem","stringify","luaFile","useMemo","start","end","map","item","join","generate_lua","yamlFile","generate_yaml","downloadLua","ReactGA","event","category","action","downloadYaml","htmlFor","cx","id","min","onClick","initialize","pageview","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.77e2d375.chunk.js","sourcesContent":["const VERSION = \"1.0.0\"\r\n\r\nexport default VERSION\r\n","import dayjs from 'dayjs'\r\nimport VERSION from './version'\r\n\r\nfunction date2int(date) {\r\n    return dayjs(date).format('YYYYMMDD')\r\n}\r\n\r\nexport function generate_lua(items, start, end) {\r\n    return `-- Generated with Secret's Attendance Generator version ${VERSION}\r\nConfig = { StartDate = ${date2int(start)}, EndDate = ${date2int(end)} }\r\nReward = {\r\n    ${\r\n        items.map((item, index) => `{ ${index+1}, ${item.itemId}, ${item.amount} }` ).join(',\\n    ')\r\n    }\r\n}\r\n\r\nmain = function()\r\n    result, msg = InsertCheckAttendanceConfig(Config.EvendOnOff, Config.StartDate, Config.EndDate)\r\n    if not result == true then\r\n        return false, msg\r\n    end\r\n    for k, rewardtbl in pairs(Reward) do\r\n        result, msg = InsertCheckAttendanceReward(rewardtbl[1], rewardtbl[2], rewardtbl[3])\r\n        if not result == true then\r\n            return false, msg\r\n        end\r\n    end\r\n    return true, \"success\"\r\nend\r\n`\r\n}\r\n\r\nexport function generate_yaml(items, start, end) {\r\n    return `# Generated with Secret's Attendance Generator version ${VERSION}\r\nHeader:\r\n  Type: ATTENDANCE_DB\r\n  Version: 1\r\n  \r\nBody:\r\n  - Start: ${date2int(start)}\r\n    End: ${date2int(end)}\r\n    Rewards:\r\n${\r\n    items.map((item, index) => \r\n`      - Day: ${index+1}\r\n        ItemId: ${item.itemId}\r\n        Amount: ${item.amount}\r\n`).join('')\r\n}\r\n`\r\n}\r\n","import React, { useState, useEffect, useCallback, useMemo } from 'react'\r\nimport dayjs from 'dayjs'\r\nimport { css, cx } from 'emotion'\r\nimport { generate_lua, generate_yaml } from './Generator'\r\nimport VERSION from './version'\r\nimport ReactGA from 'react-ga'\r\n\r\nconst DATE_FORMAT = 'YYYY-MM-DD'\r\nconst SAVE_VERSION = '1'\r\n\r\nconst FormGroup = css`\r\npadding-top: 2px;\r\npadding-bottom: 2px;\r\nmargin: 5px;\r\n`;\r\n\r\nconst Input = css`\r\npadding: 5px;\r\nborder: 1px solid rgba(0,0,0,0.2);\r\nmargin: 0 5px 0 5px;\r\nwidth: 65px;\r\n`\r\n\r\nconst DateInput = css`\r\nwidth: 127px;\r\n`\r\n\r\nconst PreviewContainer = css`\r\nwidth: 45%;\r\nheight: 250px;\r\n`\r\n\r\nconst PreviewText = css`\r\nwidth: 100%;\r\nheight: 100%;\r\n`\r\n\r\nconst DownloadButton = css`\r\nwidth: 100%;\r\nheight: 30px;\r\nbackground: #00d1b2;\r\nborder-radius: 4px;\r\nbox-shadow: none;\r\nborder: 1px solid transparent;\r\n:hover {\r\n  background: #00c4a7;\r\n}\r\n:active {\r\n  background: #00b89c;\r\n}\r\n`\r\n\r\nconst AttendanceDay = (props) => (\r\n  <div className={css`\r\n    margin: 5px;\r\n    box-sizing: border-box;\r\n    flex: 1 0 45%;\r\n  `}>\r\n    <label>Day {props.index+1} ID</label>\r\n    <input className={Input} type=\"number\" value={props.entry.itemId} onChange={(e) => props.changeItem(e.target.value, props.index)} />\r\n    <label>Amount</label>\r\n    <input className={Input} type=\"number\" value={props.entry.amount} onChange={(e) => props.changeAmount(e.target.value, props.index)} />\r\n  </div>\r\n)\r\n\r\nconst App = () => {\r\n    const now = dayjs()\r\n    const [startDate, setStartDate] = useState(now.format(DATE_FORMAT))\r\n    const [endDate, setEndDate] = useState(now.format(DATE_FORMAT))\r\n    const [items, setItems] = useState([]);\r\n    const changeItemProperty = useCallback((key, value, index) => {\r\n      setItems([\r\n        ...items.slice(0, index),\r\n        { ...items[index], [key]: value },\r\n        ...items.slice(index+1)\r\n      ])\r\n    }, [items])\r\n\r\n    useEffect(() => {\r\n      if(typeof(Storage) === 'undefined') {\r\n        return\r\n      }\r\n    \r\n      let items = localStorage.getItem('savedItems')\r\n      const saveVersion = localStorage.getItem('saveVersion')\r\n      try {\r\n        if (saveVersion !== null && saveVersion === SAVE_VERSION) {\r\n          items = JSON.parse(items)\r\n        }\r\n      } catch {\r\n        items = Array(20).fill({ itemId: 501, amount: 1})\r\n      }\r\n      if (items !== null) {\r\n        setItems(items)\r\n      } else {\r\n        setItems(Array(20).fill({ itemId: 501, amount: 1 }))\r\n      }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n      localStorage.setItem('saveVersion', SAVE_VERSION)\r\n      localStorage.setItem('savedItems', JSON.stringify(items))\r\n    }, [items])\r\n\r\n    const luaFile = useMemo(\r\n      () => generate_lua(items, startDate, endDate),\r\n      [items, startDate, endDate]\r\n    )\r\n\r\n    const yamlFile = useMemo(\r\n      () => generate_yaml(items, startDate, endDate),\r\n      [items, startDate, endDate]\r\n    )\r\n\r\n    const downloadLua = useCallback(() => { \r\n      ReactGA.event({\r\n        category: 'User',\r\n        action: 'Downloaded Lua file'\r\n      })\r\n      download('CheckAttendance.lub', luaFile)\r\n    }, [luaFile])\r\n  \r\n    const downloadYaml = useCallback(() => {\r\n      ReactGA.event({\r\n        category: 'User',\r\n        action: 'Downloaded YAML file'\r\n      })\r\n      download('attendance.yml', yamlFile)\r\n    }, [yamlFile])\r\n\r\n    return (\r\n      <div className={css`text-align: center;`}>\r\n        <header className={css`\r\n          background-color: #222;\r\n          height: 100px;\r\n          padding: 20px;\r\n          color: white;\r\n        `}>\r\n          <h1 className={css`font-size: 1.5em; margin-bottom: 5px;`}>Attendance Generator v.{VERSION}</h1>\r\n          <h5 className={css`margin-top: 0; margin-bottom: 5px;`}>for rAthena and RO Client</h5>\r\n          <h6 className={css`margin-top: 10px;`}>&copy; 2018-2019 Jittapan P. All rights reserved.</h6>\r\n        </header>\r\n        <div className={css`margin-top: 10px;`}>\r\n          <div className={css`\r\n            display: flex;\r\n            justify-content: center;\r\n          `}>\r\n            <div className={FormGroup}>\r\n              <label htmlFor=\"start\">Start date:</label>\r\n              <input className={cx(Input, DateInput)} type=\"date\" id=\"start\" onChange={e => setStartDate(e.target.value)} value={startDate} />\r\n            </div>\r\n            <div className={FormGroup}>\r\n              <label htmlFor=\"end\">End date:</label>\r\n              <input className={cx(Input, DateInput)} type=\"date\" id=\"end\" onChange={e => setEndDate(e.target.value)} min={startDate} value={endDate} />\r\n            </div>\r\n          </div>\r\n          <div className={css`\r\n            margin: 0 auto;\r\n            display: flex;\r\n            width: 100%;\r\n            flex-direction: column;\r\n            flex-wrap: wrap;\r\n            justify-content: space-around;\r\n            align-content: center;\r\n            @media screen and (min-width: 640px) {\r\n              width: 640px;\r\n              flex-direction: row;\r\n            }\r\n          `}>\r\n            {\r\n              items.map((entry, index) =>\r\n                <AttendanceDay\r\n                  changeItem={(itemId, index) => changeItemProperty('itemId', itemId, index)}\r\n                  changeAmount={(itemId, index) => changeItemProperty('itemId', itemId, index)}\r\n                  index={index}\r\n                  entry={entry}\r\n                />\r\n              )\r\n            }\r\n          </div>\r\n        </div>\r\n        <div className={css`\r\n          margin: 10px auto 0 auto;\r\n          display: flex;\r\n          justify-content: space-around;\r\n        `}>\r\n          <div className={PreviewContainer}>\r\n            <h2>CheckAttendance.lub</h2>\r\n            <textarea className={PreviewText} value={luaFile} />\r\n            <button className={DownloadButton} onClick={downloadLua}>Download</button>\r\n          </div>\r\n          <div className={PreviewContainer}>\r\n            <h2>attendance.yml</h2>\r\n            <textarea className={PreviewText} value={yamlFile} />\r\n            <button className={DownloadButton} onClick={downloadYaml}>Download</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n}\r\n\r\nfunction download(filename, text) {\r\n  var element = document.createElement('a');\r\n  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\r\n  element.setAttribute('download', filename);\r\n\r\n  element.style.display = 'none';\r\n  document.body.appendChild(element);\r\n\r\n  element.click();\r\n\r\n  document.body.removeChild(element);\r\n}\r\n\r\nexport default App;\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport './index.css'\r\nimport App from './App'\r\nimport ReactGA from 'react-ga'\r\n\r\nReactGA.initialize('UA-145842310-1')\r\nReactGA.pageview('/')\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n"],"sourceRoot":""}